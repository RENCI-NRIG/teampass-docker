# TeamPass

What is [TeamPass](https://teampass.net)?

- TeamPass is a Passwords Manager dedicated for managing passwords in a collaborative way by sharing them among team members.
Teampass offers a large set of features permitting to manage your passwords and related data in an organized way in respect to the access rights defined for each users.
Teampass is an Open-Source free to use product distributed in respect with OpenSource GNU GPL-3.0.

## TL;DR

The following will deploy TeamPass to localhost using the default configuration as found in the [.env](.env) file.

```
mkdir -p \
  volumes/teampass \
  volumes/php/session \
  volumes/db
docker-compose up -d
```

From your browser, navigate to [https://localhost:443]() and configure your TeamPass deployment.

<img width="80%" alt="Start page" src="https://user-images.githubusercontent.com/5332509/57861843-5c298b80-77c5-11e9-9c86-356eaca91ed5.png">

Enjoy!

## Setup and Configuration

### Setup

Create local directories to persist the data being generated by the TeamPass services.

```
mkdir -p \
  volumes/teampass \
  volumes/php/session \
  volumes/db
```

### Configure

Configuration is done via the [.env](.env) file. It is pre-populated with sane defaults for development evaluation on localhost using self signed SSL certificates.

File `.env`:

```
# TeamPass
VIRTUAL_HOST=localhost                   # Hostname being deployed to
LOCAL_TEAMPASS_HOME=./volumes/teampass   # Local TeamPass data directory
LOCAL_PHP_SESSION=./volumes/php/session  # Local PHP session directory

# MySQL Database
MYSQL_ROOT_PASSWORD=mypass               # MySQL root password
MYSQL_DATABASE=teampass                  # MySQL TeamPass database name
MYSQL_PASSWORD=teampass                  # MySQL TeamPass user
MYSQL_USER=teampass                      # MySQL TeamPass user password
LOCAL_DB_DATA=./volumes/db               # Local MySQL data directory

# Nginx
HTTPS_PORT=443                           # HTTPS port to serve TeamPass on
LOCAL_SSL_CERTS=./volumes/ssl            # Local SSL certificate directory
LOCAL_DOCKER_SOCK=-/var/run/docker.sock  # Local docker socket
```

**NOTE**: The contents of `LOCAL_SSL_CERTS` should contain the certificates and private keys for any virtual hosts in use. The certificate and keys should be named after the virtual host with a `.crt` and `.key` extension. For example, a container with `VIRTUAL_HOST=foo.bar.com` should have a `foo.bar.com.crt` and `foo.bar.com.key` file in the certs directory.

## Deploy

Once the environment is configured, the user can bring all the services up using docker compose.

```
docker-compose up -d
```

The user should observe three running containers

```console
$ docker-compose ps
  Name                Command                  State                  Ports
---------------------------------------------------------------------------------------
db         /entrypoint.sh mysqld            Up (healthy)   3306/tcp, 33060/tcp
nginx      /app/docker-entrypoint.sh  ...   Up             0.0.0.0:443->443/tcp, 80/tcp
teampass   /bin/sh /teampass-docker-s ...   Up             443/tcp, 80/tcp, 9000/tcp
```

From your browser, navigate to the location defined by [$VIRTUAL\_HOST:$HTTPS\_PORT]() and configure your TeamPass deployment. From the example this is [https://localhost:443]().

### Welcome page

<img width="80%" alt="Welcome" src="https://user-images.githubusercontent.com/5332509/57861843-5c298b80-77c5-11e9-9c86-356eaca91ed5.png">


## TeamPass Configuration

Starting from the configuration Welcome page, follow the prompts using the values as set from the `.env` file as they apply to each section. This generally follows the format of filling in the prompts, pressing the **Launch** button, and the pressing the **Next** button.

The following example uses the default settings as found in the `.env` file.

### Server checks

- Absolute path to teampass folder: **/var/www/html**
- Full URL to teampass: **https://localhost**

<img width="80%" alt="Server checks" src="https://user-images.githubusercontent.com/5332509/57862088-c9d5b780-77c5-11e9-9b8e-9474eb3e5a72.png">

### Database connection

- Host: **db**
- DataBase name: **teampass**
- Login: **teampass**
- Password: **teampass**
- Port: **3306**

<img width="80%" alt="Database connection" src="https://user-images.githubusercontent.com/5332509/57862598-9d6e6b00-77c6-11e9-8ca5-5db00ca0b961.png">

### Preparation

Per the [documentation](https://github.com/nilsteampassnet/TeamPass), use `/var/www/html/sk` for the absolute path of your saltkey

- Table prefix: **teampass_**
- Absolute path to SaltKey: **/var/www/html/sk**
- Administrator password: **adminpass**

<img width="80%" alt="Preparation" src="https://user-images.githubusercontent.com/5332509/57862873-11107800-77c7-11e9-8d7b-04518c5960b6.png">

### Tables creation

Press the **Launch** button to generate tables

<img width="80%" alt="Tables creation" src="https://user-images.githubusercontent.com/5332509/57863010-4fa63280-77c7-11e9-98ef-b01566ce101d.png">

### Finalization

Press the **Launch** button to finalize installation

<img width="80%" alt="Finalization" src="https://user-images.githubusercontent.com/5332509/57863128-7d8b7700-77c7-11e9-9fc7-c9d302e66aca.png">

### Resume

<img width="80%" alt="Resume" src="https://user-images.githubusercontent.com/5332509/57863199-a3b11700-77c7-11e9-9a49-bd78a2368acf.png">

Press the [Move to home page]() link and sign in

- Account: **admin**
- Password: **adminpass**

<img width="80%" alt="Home page" src="https://user-images.githubusercontent.com/5332509/57863318-dd821d80-77c7-11e9-9500-9c1d28011fb7.png">

Refer to the [documentation]() to learn about all configuration options

<img width="80%" alt="Done" src="https://user-images.githubusercontent.com/5332509/57863423-128e7000-77c8-11e9-9997-8394bc4f58af.png">

Enjoy!

## Clean up

The following commands will stop all compose services, remove them from the system, prune the associated volumes and networks, and purge the local files associated with TeamPass. The final removal command may require sudo rights depending on the permissions of the user making the call.

```
docker-compose stop && docker-compose rm -f
docker volume prune -f
docker network prune -f
rm -rf \
  volumes/teampass \
  volumes/php \
  volumes/db
```

## References

- TeamPass Documentation: [https://teampass.readthedocs.org/](https://teampass.readthedocs.org/)
- TeamPass Main site: [https://teampass.net](https://teampass.net)
- GitHub: [https://github.com/nilsteampassnet/TeamPass](https://github.com/nilsteampassnet/TeamPass)
- DockerHub: [https://hub.docker.com/r/teampass/teampass](https://hub.docker.com/r/teampass/teampass)
- jwilder/nginx-proxy: [https://github.com/jwilder/nginx-proxy](https://github.com/jwilder/nginx-proxy)


